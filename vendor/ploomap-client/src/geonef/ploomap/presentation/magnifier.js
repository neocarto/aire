dojo.provide('geonef.ploomap.presentation.magnifier');

dojo.mixin(geonef.ploomap.presentation.magnifier,



           {"actions":[{"style":{"fontSize":"1.5em"},"type":"geonef.jig.macro.action.TextRunner","text":"Présentation de la loupe","clear":true,"manualNext":true},{"type":"geonef.jig.macro.action.ScriptRunner","script":"\n  // déplacement de la loupe\nvar zoomBar = this.getUniqueWidgetByClass(\n       geonef.ploomap.OpenLayers.Control.SexyZoomBar);\nzoomBar.attr('forceAlternateLayout', true);\nzoomBar.openMagnifier();\ngeonef.jig.workspace.highlightWidget(\n         zoomBar.magnifier, 'focus');\n","scriptCallsOnEnd":false},{"style":{},"type":"geonef.jig.macro.action.TextRunner","text":"Pour ouvrir l'outil Loupe, il faut cliquer sur le bouton du même nom au dessous de la barre de zoom.","clear":true,"manualNext":true},{"type":"geonef.ploomap.macro.action.LayerRunner","layer":"worldwar2","defZIndex":false,"highlight":false,"remove":true},{"type":"geonef.ploomap.macro.action.LayerRunner","layer":"revolution_francaise","defZIndex":false,"highlight":false,"remove":true},{"type":"geonef.ploomap.macro.action.LayerRunner","layer":"GEOGRAPHICALGRIDSYSTEMS.MAPS","opacity":1,"visibility":true,"defZIndex":true,"zIndex":52,"highlight":false,"remove":false},{"type":"geonef.ploomap.macro.action.RegionRunner","region":[176070.90905229189,5435100.468608964,183366.90905229189,5441820.468608964],"noZoomChange":true},{"type":"geonef.ploomap.macro.action.MapRunner","zoom":10},{"style":{},"type":"geonef.jig.macro.action.TextRunner","text":"Une fois la loupe activée, il suffit de cliquer sur la carte puis de se déplacer pour que la loupe proprement dite apparaisse, en agrandissant la région sous le curseur de la souris.","clear":false,"manualNext":false},{"style":{"fontStyle":"italic"},"type":"geonef.jig.macro.action.TextRunner","text":"Voyez comme la loupe se déplace à présent (le mouvement est ici automatisé) ...","clear":false,"manualNext":false},{"type":"geonef.jig.macro.action.ScriptRunner","script":"\n  // déplacement de la loupe\nvar zoomBar = this.getUniqueWidgetByClass(\n       geonef.ploomap.OpenLayers.Control.SexyZoomBar);\n\nzoomBar.openMagnifier();\nzoomBar.magnifier.attr('active', false);\nzoomBar.magnifier.attr('layer', \n            'GEOGRAPHICALGRIDSYSTEMS.MAPS');\nzoomBar.magnifier.attr('opacity', 100);\nzoomBar.magnifier.attr('factor', 1); \nzoomBar.magnifier.attr('size', 150); \nzoomBar.magnifier.attr('active', true);\n\nvar duration = 20000;\nvar self = this;\nvar box = dojo.contentBox(this.mapWidget.map.div);\nvar w = box.w;\nvar h = box.h;\nvar nb = 12;\n\n// dev\n//duration = 10000;\n//nb = 3;\n// end dev\n\nthis.animation = new dojo.Animation(\n {\n    curve: [0, 1],\n    //easing: dojo.fx.easing.sinInOut,\n    duration: duration,\n    onAnimate: function(v) {\n       // set\n       var x = parseInt(w * v);\n       var y = parseInt((Math.sin(v*nb)+1)*h/2);\n       zoomBar.magnifier.move({x:x,y:y});\n    },\n    onEnd: function() { self.onEnd(); }\n});\nthis.animation.play();\n\n","scriptCallsOnEnd":true,"runnerClass":"geonef.ploomap.macro.action.MapBindingRunner"},{"style":{"fontWeight":"bold","fontStyle":"italic"},"type":"geonef.jig.macro.action.TextRunner","text":"Fin de l'animation, cliquez sur Continuer.","clear":false,"manualNext":true},{"style":{"fontSize":"1.2em","fontWeight":"bold"},"type":"geonef.jig.macro.action.TextRunner","text":"Il est possible de modifier les réglages de l'outil.","clear":true,"manualNext":false},{"style":{},"type":"geonef.jig.macro.action.TextRunner","text":"Tout d'abord, le facteur définit l'agrandissement ou le rétrécissement à opérer. ","clear":false,"manualNext":false},{"style":{"fontStyle":"italic"},"type":"geonef.jig.macro.action.TextRunner","text":"Voyez par exemple un facteur de 4x...","clear":false,"manualNext":false},{"type":"geonef.jig.macro.action.ScriptRunner","script":"\n  // déplacement de la loupe\nvar zoomBar = this.getUniqueWidgetByClass(\n       geonef.ploomap.OpenLayers.Control.SexyZoomBar);\n\nzoomBar.openMagnifier();\nzoomBar.magnifier.attr('active', false);\nzoomBar.magnifier.attr('layer', \n            'GEOGRAPHICALGRIDSYSTEMS.MAPS');\nzoomBar.magnifier.attr('opacity', 100);\nzoomBar.magnifier.attr('factor', 2); \nzoomBar.magnifier.attr('size', 150); \nzoomBar.magnifier.attr('active', true);\n\nvar duration = 15000;\nvar self = this;\nvar box = dojo.contentBox(this.mapWidget.map.div);\nvar w = box.w;\nvar h = box.h;\nvar nb = 6;\nvar pv = 0.5;\nvar ph = 0.5;\n\nthis.animation = new dojo.Animation(\n {\n    curve: [0, 1],\n    //easing: dojo.fx.easing.sinInOut,\n    duration: duration,\n    onAnimate: function(v) {\n       // set\n       var x = parseInt( w * ((1-pv)/2 + v*pv));\n       var y = parseInt((Math.sin(v*nb)*pv+1)*h/2);\n       zoomBar.magnifier.move({x:x,y:y});\n    },\n    onEnd: function() { self.onEnd(); }\n});\nthis.animation.play();\n\n","scriptCallsOnEnd":true,"runnerClass":"geonef.ploomap.macro.action.MapBindingRunner"},{"style":{"fontWeight":"bold","fontStyle":"italic"},"type":"geonef.jig.macro.action.TextRunner","text":"Fin de l'animation, cliquez sur Continuer...","clear":false,"manualNext":true},{"style":{},"type":"geonef.jig.macro.action.TextRunner","text":"Le réglage \"taille\" permet de finir en pixels le côté du carré de la zone d'agrandissement.\n\n\nL'opacité permet d'obtenir un agrandissement semi-transparent.\n","clear":true,"manualNext":false},{"style":{"fontStyle":"italic"},"type":"geonef.jig.macro.action.TextRunner","text":"Voyez un exemple avec une loupe de 250 pixels et 70 % d'opacité...","clear":false,"manualNext":false},{"type":"geonef.jig.macro.action.ScriptRunner","script":"\n  // déplacement de la loupe\nvar zoomBar = this.getUniqueWidgetByClass(\n       geonef.ploomap.OpenLayers.Control.SexyZoomBar);\n\nzoomBar.openMagnifier();\nzoomBar.magnifier.attr('active', false);\nzoomBar.magnifier.attr('layer', \n            'GEOGRAPHICALGRIDSYSTEMS.MAPS');\nzoomBar.magnifier.attr('opacity', 70);\nzoomBar.magnifier.attr('factor', 1); \nzoomBar.magnifier.attr('size', 250); \nzoomBar.magnifier.attr('active', true);\n\nvar duration = 15000;\nvar self = this;\nvar box = dojo.contentBox(this.mapWidget.map.div);\nvar w = box.w;\nvar h = box.h;\nvar nb = 6;\nvar pv = 0.5;\nvar ph = 0.5;\n\nthis.animation = new dojo.Animation(\n {\n    curve: [0, 1],\n    //easing: dojo.fx.easing.sinInOut,\n    duration: duration,\n    onAnimate: function(v) {\n       // set\n       var x = parseInt( w * ((1-pv)/2 + v*pv));\n       var y = parseInt((Math.sin(v*nb)*pv+1)*h/2);\n       zoomBar.magnifier.move({x:x,y:y});\n    },\n    onEnd: function() { self.onEnd(); }\n});\nthis.animation.play();\n\n","scriptCallsOnEnd":true,"runnerClass":"geonef.ploomap.macro.action.MapBindingRunner"},{"style":{"fontWeight":"bold","fontStyle":"italic"},"type":"geonef.jig.macro.action.TextRunner","text":"Fin de l'animation. Cliquez sur Continuer...","clear":false,"manualNext":true},{"style":{},"type":"geonef.jig.macro.action.TextRunner","text":"Voici un exemple en facteur x1. Ce n'est plus une loupe dans le sens où rien n'est agrandi ni diminué.\n\nMais la couche affichée est différente de celle de la carte, ce qui donne un moyen de lire aisément une carte avec plusieurs couches sans jouer sans cesse avec l'opacité.\n","clear":true,"manualNext":false},{"style":{"fontStyle":"italic"},"type":"geonef.jig.macro.action.TextRunner","text":"(Cliquez sur Continuer...)","clear":false,"manualNext":true},{"type":"geonef.ploomap.macro.action.LayerRunner","layer":"ORTHOIMAGERY.ORTHOPHOTOS","defZIndex":true,"zIndex":NaN,"highlight":false,"remove":false},{"type":"geonef.jig.macro.action.ScriptRunner","script":"\n  // déplacement de la loupe\nvar zoomBar = this.getUniqueWidgetByClass(\n       geonef.ploomap.OpenLayers.Control.SexyZoomBar);\n\nzoomBar.openMagnifier();\nzoomBar.magnifier.attr('active', false);\nzoomBar.magnifier.attr('layer', \n            'ORTHOIMAGERY.ORTHOPHOTOS');\nzoomBar.magnifier.attr('opacity', 100);\nzoomBar.magnifier.attr('factor', 0); \nzoomBar.magnifier.attr('size', 250); \nzoomBar.magnifier.attr('active', true);\n\nvar duration = 30000;\nvar self = this;\nvar box = dojo.contentBox(this.mapWidget.map.div);\nvar w = box.w;\nvar h = box.h;\nvar nb = 30;\n\nthis.animation = new dojo.Animation(\n {\n    curve: [0, 1],\n    //easing: dojo.fx.easing.sinInOut,\n    duration: duration,\n    onAnimate: function(v) {\n       // set\n       var x = parseInt(w * v);\n       var y = parseInt((Math.sin(v*nb)+1)*h/2);\n       zoomBar.magnifier.move({x:x,y:y});\n    },\n    onEnd: function() { self.onEnd(); }\n});\nthis.animation.play();\n\n","scriptCallsOnEnd":true,"runnerClass":"geonef.ploomap.macro.action.MapBindingRunner"},{"style":{"fontWeight":"bold","fontStyle":"italic"},"type":"geonef.jig.macro.action.TextRunner","text":"Fin de l'animation. Cliquez sur Continuer...","clear":false,"manualNext":true},{"style":{"fontSize":"1.2em","fontWeight":"bold"},"type":"geonef.jig.macro.action.TextRunner","text":"La loupe et ses réglages ont été présentés. À présent, il ne reste qu'à les expérimenter...","clear":true,"manualNext":true},{"type":"geonef.ploomap.macro.action.LayerRunner","layer":"ORTHOIMAGERY.ORTHOPHOTOS","defZIndex":false,"highlight":false,"remove":true},{"type":"geonef.jig.macro.action.ScriptRunner","script":"\n  // déplacement de la loupe\nvar zoomBar = this.getUniqueWidgetByClass(\n       geonef.ploomap.OpenLayers.Control.SexyZoomBar);\n\nzoomBar.openMagnifier();\nzoomBar.magnifier.attr('opacity', 100);\nzoomBar.magnifier.attr('factor', 1); \nzoomBar.magnifier.attr('active', true);\n","scriptCallsOnEnd":false}],"title":""}


);
